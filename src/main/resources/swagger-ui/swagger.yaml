openapi: 3.0.3
info:
  title: API MS Comparecimento SUS
  description: API responsavel por disponibilizar indicadores de comparecimento e absenteismo
  version: 1.0.0

tags:
  - name: Pacientes
    description: Indicadores individuais de comparecimento
  - name: Relatorios
    description: Relatorios gerenciais e agregados

paths:

  /pacientes/{cns}/indice-comparecimento:
    get:
      tags:
        - Pacientes
      summary: Consultar indice de comparecimento do paciente
      parameters:
        - name: cns
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Indice de comparecimento retornado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndiceComparecimentoResponse'

  /relatorios/absenteismo:
    get:
      tags:
        - Relatorios
      summary: Relatorio de absenteismo por periodo
      parameters:
        - name: dataInicio
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: dataFim
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Relatorio de absenteismo retornado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RelatorioAbsenteismoResponse'

  /relatorios/icc-medio:
    get:
      tags:
        - Relatorios
      summary: Consultar ICC medio por periodo
      parameters:
        - name: dataInicio
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: dataFim
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: ICC medio retornado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IccMedioResponse'

components:
  schemas:

    IndiceComparecimentoResponse:
      type: object
      properties:
        icc:
          type: integer
          example: 72
        classificacao:
          type: string
          example: MEDIO_RISCO
        totalComparecimentos:
          type: integer
        totalFaltas:
          type: integer
        totalConfirmacoes:
          type: integer
        ultimaAtualizacao:
          type: string
          format: date-time

    RelatorioAbsenteismoResponse:
      type: object
      properties:
        totalConsultas:
          type: integer
        totalFaltas:
          type: integer
        taxaAbsenteismo:
          type: number
          example: 28.5

    IccMedioResponse:
      type: object
      properties:
        iccMedio:
          type: number
          example: 67.4
